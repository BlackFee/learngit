## **使用安全设计原则实施和管理工程过程**

系统·开发阶段考虑安全的重要性

**开放式与封闭式系统**

在设计和构建应用系统时，有两种不同的理念：封闭式和开放式。
封闭式系统被设计用于与较小范围内的其他系统协同工作， 通常所有系统都来自相同
的制造厂商。封闭式系统的标准一般是专有的， 通常不对外公开。
而开放式系统被设计为使用统一的行业标准。这些开放式系统比较容易与来自不同制
造厂商但支持相同标准的系统集成在一起。
封闭式系统很难与不同的系统集成在一起， 但是它们更为安全。一般来说， 一
个开放式系统与其他开放式系统相集成较为容易，但系统的开放性使它们更容
易受到攻击， 并且这种广泛的可用性，使得攻击者能够查找(甚至攻击)大量的
潜在目标。 

**客体与主题**

在安全系统中，对任何资源的访问控制都会涉及两个实体：客体和主题。其中，
**客体是用户或进程想要访问的资源，主体是请求访问资源的用户或进程。**访问
的意思是可以对资源进行读或写操作。需要记住的是， 主体和客体的界定，仅
仅针对特定的访问请求。因此对于不同的同一资源既可以成为主体， 也可以在
不同的访问请求中成为客体 

**安全技术（开发过程中）**

确保机密性、完整性和可用性的技术有：限制、界限和隔离。 

- 限制
- 界限
- 隔离

限制指的是软件设计人员使用进程限制，来约束程序的操作。简单来讲， 进程限制允许进程只能在确定的内存地址和资源中，读取和写入数据。这就是常说的沙箱。操作系统或其他一些安全组件不允许非法的读/写请求。如果进程试图执行的动作超出了它们被授予的权限， 那么动作就会被拒绝， 并且系统还会采取进一步的行动， 例如记录违法行为的日志。一些更高安全性级别的系统通常记录所有违规行为，以及通过某些具体方式做出的响应。一般情况下， 违规的进程会被终止。限制可以在操作系统中进行，例如通过进程隔离和保护， 也可通过限制应用程序或服务的使用来进行， 或通过虚拟化或虚拟机解决方案来进行。

界限指的是在系统上运行的每一个进程都被分配了一个授权级别。授权级别告知操作系统进程可以执行哪些操作。在比较简单的系统中， 可能只存在两个授权级别，它们是：用户和内核。授权级别告知操作系统该如何为进程设定界限。进程的界限由对进程可以访问的内存和资源所设置的限制组成。进程在界限所划定的区域之内。

隔离指的是：当通过实施访问界限对进程进行限制时， 进程就运行在隔离状态中。进程隔离能够确保任何行为只影响与隔离进程有关的内存和资源。隔离用来保护操作环境、操作系统的内核和其他独立的应用程序。隔离是稳定操作系统的重要组成部分之 一。隔离能防止某个应用程序去访问仅属于另一个应用程序的内存或资源， 无论是好意的还是恶意的。操作系统可以提供中间服务，例如剪切、粘贴，以及例如键盘、网络接口和存储设备访问方面的资源共享 。 

控制

信任与保证

## 系统机构和可信计算基

系统架构：

系统架构描述了系统的主要组件，以及系统组件之间、系统与用
户之间，以及系统与其它系统之间，如何相互交互。 

系统安全架构的目标：安全策略

可信计算机系统评价标准：Trusted Computer System Evaluation Criteria ，几乎为今天使用的所有系统提供了应该遵循的安全架构 

安全架构核心内容：

**可信计算基** ：Trusted Computing Base，简称TCB，指的是系统内提供某类安
全并实施系统安全策略的所有硬件、软件和固件的组合。 

**安全边界**(security perimeter)是划分可信与不可信的边界。 

**引用监控器**(reference monitor)定义了引用验证机制必须满足的设计
要求，从而它能够正确执行系统型访问控制策略的规定 。它是主体对客体进行所有访问的中介，不但要确保主体拥有必要的访问权限，而且还要保护客体不被未授权访问和破坏性更改。 

**安全内核**由位于TCB内的硬件、软件和固件组件构成，并且实现和实
施引用监控器概念 

我们还会用一个简洁的类比，来展示构成安全内核的进程、安全内核本身与引
用监控器概念之间的关系。若干个人组成一个社会，**个人代表进程，社会则代**
**表安全内核。**社会具有一定的生活标准，其成员必须以特定的方式进行交互，
这就是我们需要法律的原因。**法律代表引用监控器**，它实施适当的活动。每个
人都被要求不超出法律的界线，并且以特定的方式行事，从而使社会在整体上
不会受到不利的影响，生活标准也不会遭到威胁。一个系统内部的组件必须不
超出引用监控器法律的界线，以便它们不会对其他组件造成不利影响，也不会
威胁这个系统的安全。 

## **安全模型和实例**

安全模型：

- 安全模型通常以数学和分析的理念来表示
- 映射到系统的规范说明上
- 由编程人员通过编写代码开发出来 

Bell-LaPadula模型

Biba 模型 

Clark-Wilson 模型 

Brewer and Nash 模型 

无干扰模型

## 系统安全评估模型

**TCSEC**

也被称为橘皮书 

TCSEC从网络安全的角度出发，解释了准则中的观点，从用户登录、授权管理、
访问控制、审计跟踪、隐通道分析、可信通道建立、安全检测、生命周期保障、
文本写作、用户指南均提出了规范性要求，并根据所采用的安全策略、系统所
具备的安全功能将系统分为四类七个安全级别。分级主要依据四个准则：安全
政策、可控性、保证能力、文档。将计算机系统的可信程度划分为D、C1、C2、 B1、B2、B3和A1 七个安全级别。四个类分别为：类别A，是指已验证保护， 这是最高的安全级别；类别B，是指强制性保护；类别C，是指自主性保护；类别D，是指最小化保护， 提供用于那些被评估，但不符合要求且属于其他类别的系统定级 .

**ITSEC**

**通用准则**

通用准则过程基于两个关键元素:

- 保护轮廓（PP）
- 安全目标（ST） 

保护轮廓(PP)指定被评估目标（TOE)的安全需求和保护， 这也是客户考虑的安全要求或“希望达到的标准”。安全目标(Security Targets， ST)指定了供应商在TOE 内构建的安全声明。
ST 被视为已实现的安全措施或供应商"提供的安全目标"。将PP 与选定供应商的
TOE 中的各种ST 进行比较， 最接近或最匹配的就是客户要购买的。 

7个保证级别、结构

## 对安全模型和架构的威胁



**维护陷阱**

维护陷阱(maintenance hook)是一种后门，是软件内只有开发
人员才知道和能够调用的指令，从而使他们能够方便地访问代码。
• 对策：
 使用主机入侵检测系统监视通过后门进入系统的攻击者。
 使用文件系统加密来保护敏感信息。
 实现审计，以检测任何类型的后门使用。 

**检验时间/使用时间攻击**

检验时间/使用时间（TOC/TOU）攻击涉及系统完成某项任务所使用
的一系列步骤。这种攻击利用了多任务处理操作系统中发生的事件的
时序依赖性。
• 竞争条件(race condition)是指两个不同的进程需要在同一个资源上执
行其任务的情况。
• 为了避免TOC/TOU攻击，如果操作系统能够应用软件锁，那么最好在
它执行“检查”任务时锁定将要使用的项。 

## **密码学定义与概念**

加密/解密
明文/密文	
算法/密钥
密码系统/密钥空间

**Kerckhoffs 原则** 

• Kerckhoffs于1883 年发表了一篇论文，指出一个密码系统唯一需要保
密的部分应当是密钥，算法应当公开
• 如果安全基于过多的秘密，那么就会有更多的脆弱性可供利用。
• 与当今盛行的开放源代码和编译软件之间的争论基本相似 

**密码系统强度**

• 加密方法的强度**源自算法的复杂程度、密钥的机密度、密钥的长度**
**初始化向量以及它们如何在密码系统内协同工作**
• 设计加密方法的目标是使破解过程过于昂贵或十分费时
• 密码系统强度也称为**工作因数(work factor)**，即对攻击者破译一个
码系统所付出的努力和资源进行估计。
• 保护机制的强弱程度应取决于被保护数据的敏感程度。 

密码系统可以提供以下服务：
• **机密性** 除了授权实体之外，其他实体无法理解提交的数据。
• **完整性** 数据从创建到传输、存储都不会被未授权更改。
• **身份验证** 对创建信息的用户或系统的身份进行验证。
• **授权** 证明身份之后，向个体提供允许访问某些资源的密钥或密码。
• **不可否认性** 确保发送方无法否认发送过消息。 

**一次性密码本**
**隐写术**

## 对称密码学

• 优点：
 比非对称系统快得多（计算密集度较低）。
 在使用大密钥时很难攻破。
• 弱点：
 需要一个恰当分发密钥的安全机制。
 每对用户都需要唯一的密钥，因此密钥数呈指数增长，密钥管理任务繁重不堪。
 能够提供机密性，但是不能提供真实性或不可否认性。 

**对称加密**两种基本类型

**替换和置换**

置换：调换原来字母的位置

替换：用不同的字符替换原来的字符

**对称算法**两种主要类型

**分组密码和流密码**
当使用分组密码来加密和解密时，消息会被划分为若干位分组。这些分组随后会通过数学函数进行处理，每次一个分组。
当使用流密码时，每加密一次，相同的明文位会转换为不同的密文位。流密码
使用了密码流生成器来生成的位流，与明文位进行异或，从而产生密文。

这两种类型可能会用到初始化向量（IV），IV是算法用于确保加密过程中不会产
生某种模式的随机值。 

**分组密码模式**

分组密码有几种操作模式，每种模式都指定一种分组密码的运作方式，
例如：
 电子密码本(Electronic Code Book，ECB)
 密码分组链接(Cipher Block Chaining，CBC)
 密码反馈(Cipher Feedback，CFB)
 输出反馈(Output Feedback，OFB)
 计数器模式(Counter Mode，CTR) 

对称加密算法

**数据加密标准（DES）** 
DES已经被一台名为DES破解者的专用计算机破解，现在基本已经不会被使用了。 

**三重DES** 
使用3个不同的密钥进行加密，数据被加密、解密、再加密。 

**高级加密标准（AES）** 
支持128、192和256位的密钥 
目前我们主要使用的加密标准 

AES是一个标准，Rijndael（读作rain-dahl）才是AES内使用的算法，我们前面讲的数据加密标准DES的算法是DEA。 

其它有的比较常见的对称加密算法有国际数据加密算法（IDEA）、Blowfish和
RC系列。其中：
国际数据加密算法（IDEA）是一种分组密码，它处理64位数据分组，并且使用
的密钥长度为128位；
Blowfish属于分组密码，它处理64位数据分组，而密钥长度为32至448位之间；
**RC4是最常用的一种流密码** 

## 非对称密码学

• 优点：
 具有比对称系统更好的密钥分发功能。
 具有比对称系统更好的扩展性。
 能提供身份验证和不可否认性。
• 弱点：
 比对称系统运行要慢。
 是数学密集型任务。 



算法实例：

• Rivest-Shamir-Adleman（RSA）
• 椭圆曲线密码系统（ECC）
• Diffie-Hellman
• El Gamal 

RSA算法，是一种公钥算法，也是非对称算法中最流行的算法。RSA是事实上的
全球标准，能够用于数字签名、密钥交换和加密。
椭圆曲线密码系统（ECC）提供的功能与RSA 相似：数字签名、安全密钥分发和
加密。一个不同的因素是ECC的效率。ECC比RSA和其他非对称算法的效率更高。
Diffie-Hellman 算法使两个系统不需要提前建立关系或预先安排就能安全地交换
对称密钥。这种算法可实现密钥发送，但并不提供加密或数字签名功能。
El Gamal是一种可用于数字签名、加密和密钥交换的公钥算法。 

混合算法：使用对称算法通信，实用非对称算法加密对称算法密钥

会话密钥：是只使用一次的对称密钥 ，密钥仅仅在一次对话中使用，交谈完毕就作废 

## 散列算法

散列是一种函数，它将可变长的字符串或消息压缩变换成固定长度
的值，用来检测位流从一台计算机传送到另一台计算机时是否被更改 

**MD5    SHA**

**消息身份验证码（MAC）**函数是通过以某种形式对消息应用秘密密钥而派生的
一种身份验证机制，但要注意并不表示它使用对称密钥来加密消息。 

**数字签名**是使用发送方的私钥加密的散列值。 

散列函数确保了消息的完整性，散列值的签名则提供了身份验证和
不可否认性。签名动作实际上就是使用私钥加密散列值 

## 密码学应用

**可信平台模块TPM**本质上是一种安全设计的微控制器，这种微控制器加入了执
行加密功能的模块。这些模块可加速与存储加密密钥、散列值和代号序列处理
过程。TPM的内部存储是基于非易失性随机存取内存的，这种内存在电源关闭
时仍旧可保留其信息，因此称为非易失性内存。
TPM内部的内存分为两个不同的部分：持久性（也称为静态性）内存模块，以
及通用性（也称为动态性）内存模块。 

**应用：**

保护电子邮件

保护web传输

​	SSL --> TLS

网络连接：Ipsec ,链路加密等

**公钥基础设施（PKI）** 

**认证授权机构CA** 

**证书**是用于将公钥和唯一标识其所有者所需的组成部分关联起来的机制。 

**注册授权机构（RA）**执行证书注册任务

PKl提供的安全服务有：
机密性
访问控制
完整性
身份验证
不可否认性 

## 密钥管理和针对密码学的攻击

**密钥管理**是指密钥的生成、分发、安装、存储、更改、控制和处置，其中每个
环节的缺陷都有可能导致密码系统的失效，密钥管理比密码算法更容易受到攻
击； 

**针对密码学的攻击**

1.唯密文攻击 : 在这种攻击中，攻击者拥有若干消息的密文，每条消息都是使用
相同的加密算法加密的。攻击者的目标是找出加密过程中使用的密钥。一旦攻
击者找到密钥，它就可以解密使用相同密钥加密的其他所有消息。
2. 已知明文攻击 : 在已知明文攻击中，攻击者拥有一条或多条消息的明文和相
对应的密文。同样，攻击者的目标是找出用于加密消息的密钥，从而能够解密
和读取其他消息。
3. 选定明文攻击:在选定明文攻击中，攻击者拥有明文和密文，不过可以选择已
加密的明文来查看相应的密文。这赋予了攻击者更强大的攻击力，也使得他们
可能更深入地理解力加密过程的工作方式，从而能够获得关于正在使用的密钥
的更多信息。一旦密钥被发现，使用该密钥加密的其他消息就都能够被解密。
4. 选定密文攻击:在选定密文攻击中，攻击者选择将要解密的密文，并且可以获
得解密后的明文。同样，攻击的目标是找出密钥。这是一种比前儿种攻击都更
为困难的攻击，攻击者可能需要控制包含密码系统的系统。
5. 差分密码分析:差分密码分析攻击也以找出加密密钥为目标。这种攻击会查看对具有特定差异的明文进行加密而生成的密文对，并且分析这些差异的影响和结果。

6. 线性密码分析 : 线性密码分析通过执行函数来确定使用分组算法的加密过程中
利用某个特定密钥的最大概率。攻击者会对使用相同密钥加密的几条不同消息
执行已知明文攻击。攻击者能够使用并使其经受这种攻击的消息越多，针对某
个特定密钥值概率的可信度就越高。
7. 旁路攻击 :旁路攻击的原理在于不用直接攻击一台设备，而是只须监视它如何
运行就可以了解其工作机制。攻击者可能会测量功率消耗、辐射排放以及进行
某些数据处理的时间。借助这些信息，攻击者就可以通过逆向工程倒推处理过
程，以获得加密密钥或敏感数据。功耗攻击会查看所排放的热量，攻击者已经
使用这种攻击成功从智能卡中获取了机密信息。
8. 重放攻击:在分布式环境中，人们极为关心的一个问题是重放攻击。重放攻击
就是攻击者捕获了某些类型的数据并重新提交它，从而寄希望于欺骗接收设备
误以为这些是合法信息。很多时候，捕获并重新提交的数据是身份验证信息，
此时攻击者试图假扮成另一个人以获得对资源的未授权访问。
9. 代数攻击:代数攻击分析算法内使用的数学原理中存在的脆弱性，并利用了其
内在的代数结构。
10. 分析式攻击:与简单穷尽全部可能性但并不注意算法特殊性的蛮力攻击相反，
分析式攻击会确定算法结构上的弱点或缺陷。
11 统计式攻击:统计式攻击确定算法设计中的统计弱点并对其加以利用。
12. 社会工程攻击:攻击者可以通过各种社会工程攻击类型诱使人们提供加密密钥
材料。它们是非技术性的攻击，攻击者的目标是引诱人们泄露某种类型的敏感
信息，这些信息可以被攻击者利用，带着这样的目标，攻击者对人们进行攻击。
攻击者可能说服受害者，表明他是一个安全管理员，需要加密数据来完成某种
类型的操作。然后，攻击者可以利用这些数据进行解密，并获得对敏感数据的
访问。通过说服、强迫（软磨硬泡攻击）或者贿赂（购买密钥攻击）这些手段，
可以顺利实施攻击。 

## 站点规划和设计

**通过环境设计来预防犯罪（Crime Prevention Through Environmental Design，CPTED）**是一门学科，它研究如何正确设计通过直接影响人类行为而减少犯罪的物理环境。 

3种主要策略：自然访问控制、自然监视以及自然区域加固 

**自然访问控制**指的是通过设置门、栅栏、照明甚至绿化来引导进出某个自然访
问控制设施的人。
**自然监视**的目标在于：通过为观察者提供许多可以观察到犯罪分子的方法，让
犯罪分子感到不适；同时提供一个开放的、精心设计的环境，让其他所有人感
到安全舒适。 

**自然区域加固**，它建立强调或延伸公司物理影响范围的物理设计，让合法用户
在那个空间具有归属感。区域加固可通过使用墙壁、栅栏、绿化、照明设备、
标志、清晰标记的地址以及装饰性的人行道来实现。**区域加固的目标是为了建**
**立一种专属社区感。公司采取这些措施是为了让员工对他们的环境感到自豪和**
**建立他们的归属感。**执行这些措施还会让潜在的罪犯觉得他们不属于这个地方，
他们的行为有被发现的危险，而且他们的违法行为不会被容忍或忽视。 

**物理安全计划**

考虑：建筑设施的选定和设计、如何建造、入口的设置、内部分离、计算机机房和设备房如何构造等问题 

## 实施物理安全

周边物理安全

物理访问控制的使用、监控人员、设备的进入和离开， 还有审计/记录所有的物
理事件，是维护整体组织安全的关键要素，包括：
 栅栏、大门、旋转门和陷阱
 照明
 保安和看门狗 

内部物理安全

• 如果设备采用限制区域来控制物理安全， 那就需要用机制来控制访问
者。
• 使用钥匙、密码锁、徽章、运动探测器、入侵报警等会对访问者控制
有好处。
• 不论在任何情况和任何条件下， 保护人员生命是安全的最重要方面。
• 安全策略必须符合行业和管辖权内的现行监管要求。 





复习点：

安全模型的概念